---
layout: post
title: Malicious Code and Activity
categories: cybersecurity
link: https://collab.its.virginia.edu/access/content/group/e7990662-1551-41b1-99bd-0539849f7d83/CS3710_Week11.pdf
---

- Malicious software (malware) - any program that carries out actions that aren't desired
- Malicious code attacks all three informatino properties (CIA)

# How a virus works

Viruses **must attach to a host**

- Infection vector - some way to spread. Includes a routine that finds target files and a replicate routine to copy itself onto the target program
- Trigger - a **logic bomb**, the action that brings the payload to fruition (some double-click, a time/date . . .)
- Payload - delete files, eavesdropping, stealing data . . .

# Rootkits

- Hides itself on computer by replacing an existing program
- Modify the OS to conceal itself
- Provide attackers with access to compromised computers so they can launch more attacks
- Difficult to detect and remove

# Worms

- Doesn't require an activation by the host

## Process

1. Infect host
2. Sends itself to other hosts, without anything done by user
3. Propagation continues until some worm-triggering condition expires or security patches come in

# StuxNet

1. Infection - enters via a USB to infect any Windows computer and obtaining a digital certificate that makes it look like a reliable company
2. Search - check to see if a machine is part of some control system made by Siemens (high-speed Iranian centrifuge machines for nuclear)
3. Update - ignore non-targets, if it hits a target, download most recent version from Internet
4. Compromise - exploit zero day vulnerabilities in the logic controllers
5. Control - control the centrifigues and force them to spin themselves to failure
6. Deceive and estroy - tell outside controllers that everything is fine.

# Trojan Horses

- Largest class of malware
- Any program that seems legitimate but hides malicious code
- Relies on social engineering
- Spreads in many ways (email, website downloads, networking sites, bots)

# Logic Bombs

- Waits until some time/condition b4 execution
- Typically associated with **insiders** (often disgruntled)

# Botnets

Not malware, but _used to launch malware_ or launch spam (often including malware)

1. Infection
2. Connection
3. Control
4. Multiplication

# Smurf

- Ping overload DOS attack

# Keystroke logger

- Capture keystrokes and send back to attacker

# Guidelines for recognizing hoaxes

- Did a legitimate entity send the alert
- Is there a request to forward it to others?
- Are there detailed explanations or terminology?
- Does the alert follow the generic chain letter format?

# Homepage Hijacking

- Reset homepage of a browser
- Covertly install a BHO browser helper object Trojan

# Webpage Defacements

- Someone gaining unauthorized access to a web server and altering the index page of a site on the server
- Replaces the original pages on the site with altered versions

# Malware analysis

- Determine nature/purpose of malware
- Understand the inner workings, how to detect, how to destroy
- How was the target compromised? How big of a deal is the compromise?
- Analyze the suspect binary in a sandbox.

## Analysis methods

- Static analysis - examining code without executing application
- Dynamic analysis - testing during runtime
- Code analysis
  - Static - debugging and disassembly
  - Dynamic - debugging and disassembly
- Memory analysis - what was placed in RAM and what artifacts are there

## Binary Discovery - Finding Malware

- `find / -executable -type f` - return executables
- `file /bin/cat`
- `ls -alt /bin/`
- `updatedb`
- `locate 'cat`
- `which bash`
